window.appAspro=window.appAspro||{},window.appAspro.filterSearch||(window.appAspro.filterSearch={filterIndex:new Map,mobileExpand:function(e,t=!1){if(e){const s=e.querySelector(".filter-search");s&&(t?s.classList.add("filter-search--mobile-hide"):s.classList.remove("filter-search--mobile-hide"))}},buildIndexForBlock:function(e){const t=e.dataset.property_id;if(!t||this.filterIndex.has(t))return;const s=new Map;e.querySelectorAll(".filter-value-wrap").forEach((e=>{const t=e.querySelector(".filter-value-text"),r=(t?.getAttribute("title")||t?.textContent||"").toLowerCase().trim();r&&s.set(r,e)})),this.filterIndex.set(t,s)},clearAll:function(){this.filterIndex.clear()},handleInput:function(e){const t=e.closest(".bx_filter_block"),s=e.closest(".bx_filter_parameters_box"),r=s?.dataset.property_id;if(!r||!s)return;this.buildIndexForBlock(s);const i=this.filterIndex.get(r),l=e.value.toLowerCase().trim(),o=t.querySelectorAll(".filter-value-wrap");o.forEach((e=>e.classList.add("hidden")));const a=t.querySelector(".expand_block");l?(i.forEach(((e,t)=>{t.includes(l)&&e.classList.remove("hidden")})),a.classList.contains("expand_block--opened")||a.click(),a&&a.classList.add("hidden")):(o.forEach((e=>e.classList.remove("hidden"))),a&&a.classList.remove("hidden"));const n=s.querySelector(".filter-search-empty-title"),c=Array.from(o).some((e=>!e.classList.contains("hidden")));n&&(c?n.classList.add("hidden"):n.classList.remove("hidden"))},init:function(){const e=this,t=debounce((function(t){e.handleInput(t)}),150);document.addEventListener("input",(e=>{e.target&&e.target.classList.contains("filter-search-values")&&t(e.target)})),document.addEventListener("click",(e=>{if(e.target.closest(".filter-search__close")){const t=e.target.closest(".filter-search__close").closest(".filter-search").querySelector(".filter-search-values");t.value="",t.focus(),window.appAspro?.filterSearch?.handleInput&&window.appAspro.filterSearch.handleInput(t)}})),BX.addCustomEvent("onAjaxSuccess",(function(){e.clearAll()})),BX.addCustomEvent("onCompleteAction",(function(){e.clearAll()}))}}),BX.Aspro.Utils.readyDOM((()=>{appAspro.filterSearch.init()}));