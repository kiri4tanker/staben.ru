BX.Aspro.Utils.readyDOM((()=>{$.extend($.validator.messages,{required:BX.message("JS_REQUIRED"),email:BX.message("JS_FORMAT"),equalTo:BX.message("JS_PASSWORD_COPY"),minlength:BX.message("JS_PASSWORD_LENGTH"),remote:BX.message("JS_ERROR")}),$.validator.addMethod("regexp",(function(e,a,t){var o=new RegExp(t);return this.optional(a)||o.test(e)}),BX.message("JS_FORMAT")),$.validator.addMethod("filesize",(function(e,a,t){return this.optional(a)||a.files[0].size<=t}),BX.message("JS_FILE_SIZE")),$.validator.addMethod("date",(function(e,a,t){var o,r,n=!1;!e||e.length<=0?n=!1:(o=new RegExp("^([0-9]{4})(.)([0-9]{2})(.)([0-9]{2})$").exec(e))?n=(r=new Date(o[1],o[3]-1,o[5])).getMonth()==o[3]-1&&r.getDate()==o[5]&&r.getFullYear()==o[1]:(o=new RegExp("^([0-9]{2})(.)([0-9]{2})(.)([0-9]{4})$").exec(e))&&(n=(r=new Date(o[5],o[3]-1,o[1])).getMonth()==o[3]-1&&r.getDate()==o[1]&&r.getFullYear()==o[5]);return n}),BX.message("JS_DATE")),$.validator.addMethod("extension",(function(e,a,t){return t="string"==typeof t?t.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(a)||e.match(new RegExp(".("+t+")$","i"))}),BX.message("JS_FILE_EXT")),$.validator.addMethod("captcha",(function(e,a,t){let o=$(a).closest("form").find('input[name="captcha_sid"]');o.length||(o=$(a).closest("form").find('input[name="captcha_code"]'));let r=o.val();return $.validator.methods.remote.call(this,e,a,{url:arAsproOptions.SITE_DIR+"ajax/check-captcha.php",type:"post",data:{captcha_word:e,captcha_sid:r}})}),BX.message("JS_ERROR")),$.validator.addMethod("recaptcha",(function(e,a,t){return!BX.Aspro?.Captcha||BX.Aspro.Captcha.validate(a)}),BX.message("JS_RECAPTCHA_ERROR")),$.validator.addClassRules({confirm_password:{equalTo:'input[name="REGISTER[PASSWORD]"]',minlength:6},password:{minlength:6},inputfile:{extension:arAsproOptions.THEME.VALIDATE_FILE_EXT,filesize:5e6},captcha:{captcha:""},recaptcha:{recaptcha:""}}),$.validator.setDefaults({highlight:function(e){$(e).parent().addClass("error")},unhighlight:function(e){$(e).parent().removeClass("error")},errorPlacement:function(e,a){e.insertBefore(a)}})})),$(document).on("click",".captcha_reload",(function(e){e.preventDefault();const a=$(this).parents(".captcha-row");$.ajax({url:arAsproOptions.SITE_DIR+"ajax/captcha.php",success:function(e){a.find("input[name=captcha_sid],input[name=captcha_code]").val(e),a.find("img").attr("src","/bitrix/tools/captcha.php?captcha_sid="+e),a.find("input[name=captcha_word]").val("").removeClass("error"),a.find(".captcha_input").removeClass("error").find(".error").remove()}})})),BX.addCustomEvent("onSubmitForm",(function(e){try{"object"==typeof e&&e&&e.form&&(e.form instanceof Node||(e.form=e.form[0]),new Promise(((a,t)=>{BX.Aspro?.Captcha?BX.Aspro.Captcha.onSubmit(e).then((e=>{a(e)})).catch((e=>{t(e)})):a(!0)})).then((a=>{a&&(e.form.submit(),e.form.closest(".form")&&e.form.closest(".form").classList.add("sending"))})))}catch(e){console.error(e)}}));